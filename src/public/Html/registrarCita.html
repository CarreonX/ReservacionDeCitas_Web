<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Dashboard Médico</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="../CSS/estiloMenu.css">

    <link rel="icon" href="../Icons/icono_Clinica.ico" type="image/x-icon">
</head>

<body>
    <!-- NAVBAR ORIGINAL, NO MODIFICADO -->
    <nav class="nav">
        <div class="nav_container">

            <h1 class="nav_title" id="nombreMedicoNav"><img src="../Images/logo_Clinica.png" alt="logo"
                    style="width: 60px; height: 60px;"></h1>


            <a href="#menu" class="nav_menu">
                <img src="../Icons/menu-hamburguesa_bco.png" class="nav_icon" alt="un logo">
            </a>
            <a href="#" class="nav_menu nav_menu--second">
                <img src="../Icons/cruz_bca.png" class=" nav_icon" alt="un logo">
            </a>

            <ul class="dropDown" id="menu">

                <li class="dropDown_list">
                    <a href="#" class="dropDown_link">
                        <img src="../Icons/hogar.png" class="dropDown_icon" alt="un logo">
                        <span class="dropDown_span">Inicio</span>
                    </a>
                </li>

                <li class="dropDown_list">
                    <a href="#" class="dropDown_link">
                        <img src="../Icons/actualizar.png" class="dropDown_icon" alt="un logo">
                        <span class="dropDown_span">Actualizar</span>
                        <img src="../Icons/angulo-derecho.png" class="dropDown_arrow" alt="un logo">
                        <input type="checkbox" class="dropDown_check" title="" placeholder="f">
                    </a>
                    <div class="dropDown_content">
                        <ul class="dropDown_sub">
                            <li class="dropDown_li">
                                <a href="#" class="dropDown_anchor">Cita</a>
                            </li>
                            <li class="dropDown_li">
                                <a href="#" class="dropDown_anchor">Paciente</a>
                            </li>
                        </ul>
                    </div>
                </li>

                <li class="dropDown_list">
                    <a href="#" class="dropDown_link">
                        <img src="../Icons/basura.png" class="dropDown_icon" alt="un logo">
                        <span class="dropDown_span">Eliminar</span>
                        <img src="../Icons/angulo-derecho.png" class="dropDown_arrow" alt="un logo">
                        <input type="checkbox" class="dropDown_check" title="" placeholder="f">
                    </a>
                    <div class="dropDown_content">
                        <ul class="dropDown_sub">
                            <li class="dropDown_li">
                                <a href="#" class="dropDown_anchor">Cita</a>
                            </li>
                            <li class="dropDown_li">
                                <a href="#" class="dropDown_anchor">Paciente</a>
                            </li>
                        </ul>
                    </div>
                </li>

                <li class="dropDown_list">
                    <a href="#" class="dropDown_link">
                        <img src="../Icons/editar.png" class="dropDown_icon" alt="un logo">
                        <span class="dropDown_span">Registrar</span>
                        <img src="../Icons/angulo-derecho.png" class="dropDown_arrow" alt="un logo">
                        <input type="checkbox" class="dropDown_check" title="" placeholder="f">
                    </a>
                    <div class="dropDown_content">
                        <ul class="dropDown_sub">
                            <li class="dropDown_li">
                                <a href="/registrarCita/<%= idMedico %>" class="dropDown_anchor">Cita</a>
                            </li>
                            <li class="dropDown_li">
                                <a href="#" class="dropDown_anchor">Paciente</a>
                            </li>
                        </ul>
                    </div>
                </li>

                <li class="dropDown_list">
                    <a href="#" class="dropDown_link">
                        <img src="../Icons/usuario.png" class="dropDown_icon" alt="un logo">
                        <span class="dropDown_span">Mi información</span>
                    </a>
                </li>

                <li class="dropDown_list">
                    <a href="#" class="dropDown_link">
                        <img src="../Icons/interrogatorio.png" class="dropDown_icon" alt="un logo">
                        <span class="dropDown_span">Ayuda</span>
                    </a>
                </li>
            </ul>
        </div>
    </nav>


    <div class="contenedor_form">
        <h2>Registrar Nueva Cita</h2>

        <!-- Nota: removí action/method para que solo haga fetch desde JS -->
        <form id="formCita" onsubmit="return false;">
            <label>ID Médico</label>
            <!-- input visible readonly -->
            <input type="text" id="idMedico" name="idMedico" readonly>

            <label>ID Paciente</label>
            <input type="number" id="idPaciente" name="idPaciente" required>

            <label>Motivo de la Cita</label>
            <input type="text" id="motivoDeCita" name="motivoDeCita" required>

            <label>Duración (minutos)</label>
            <input type="number" id="duracion" name="duracion" required>

            <label>Estado</label>
            <select id="estado" name="estado" required>
                <option value="Pendiente">Pendiente</option>
                <option value="Confirmada">Confirmada</option>
                <option value="Cancelada">Cancelada</option>
            </select>

            <label>Fecha de la Cita</label>
            <input type="date" id="fechaCita" name="fechaCita" required>

            <label>Hora</label>
            <input type="time" id="hora" name="hora" required>

            <label>Nota</label>
            <textarea id="nota" name="nota"></textarea>

            <!-- botón tipo button para evitar submit HTML -->
            <button id="btnRegistrar" type="button">Registrar Cita</button>
        </form>
    </div>

    <!-- scripts -->
    <script>
        // obtiene el id del path: /dashboardMedico/5 -> "5"
        function getIdMedicoFromPath() {
            const parts = window.location.pathname.split("/");
            return parts[parts.length - 1] || null;
        }

        // al cargar la página colocamos el id en localStorage, en el input y el link
        document.addEventListener("DOMContentLoaded", () => {
            const id = getIdMedicoFromPath();
            if (id) {
                localStorage.setItem("idmedico", id);            // clave coherente con el JS
                const inputId = document.getElementById("idMedico");
                if (inputId) inputId.value = id;
                // actualizar enlace registrar
                const link = document.getElementById("linkRegistrarCita");
                if (link) link.href = `/registrarCita/${id}`;
            }
        });
    </script>

    <!-- carga tu JS corregido -->
    <script src="../js/citas.js"></script>
</body>

</html>